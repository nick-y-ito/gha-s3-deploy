name: Deploy to AWS S3
description: Deploy a static website to AWS S3
icon: arrow-up
color: green
inputs:
  aws-access-key-id:
    description: AWS Access Key ID for authentication
    required: true
  aws-secret-access-key:
    description: AWS Secret Access Key for authentication
    required: true
  bucket-name:
    description: The name of the S3 bucket where your website will be hosted
    required: true
  bucket-region:
    description: The region of the S3 bucket
    required: false
    default: us-east-1
  src-folder:
    description: Absolute path of the folder containing the deployable files
    required: false
    default: .
outputs:
  website-url:
    description: The URL of your website hosted on S3
    value: ${{ steps.output-url.outputs.website-url }}
runs:
  using: "composite"
  steps:
    - name: Configure AWS Credentials
      shell: bash
      run: |
        aws configure set aws_access_key_id ${{ inputs.aws-access-key-id }}
        aws configure set aws_secret_access_key ${{ inputs.aws-secret-access-key }}
    - name: Sync S3
      shell: bash
      run: aws s3 sync ${{ inputs.src-folder }} s3://${{ inputs.bucket-name }} --region ${{ inputs.bucket-region }}
    - name: Output URL
      id: output-url
      shell: bash
      run: echo 'website-url="http://${{ inputs.bucket-name }}.s3-website-${{ inputs.bucket-region }}.amazonaws.com/"' >> $GITHUB_OUTPUT ';'
